!function(e){function t(t){for(var o,l,i=t[0],d=t[1],c=t[2],u=0,p=[];u<i.length;u++)l=i[u],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&p.push(a[l][0]),a[l]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(e[o]=d[o]);for(r&&r(t);p.length;)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,i=1;i<n.length;i++){var d=n[i];0!==a[d]&&(o=!1)}o&&(s.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},a={2:0},s=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=o);var s,i=document.createElement("script");i.charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.src=function(e){return l.p+""+({1:"instead-js"}[e]||e)+"."+{1:"8e11af2e6fedd5320fc7"}[e]+".js"}(e);var d=new Error;s=function(t){i.onerror=i.onload=null,clearTimeout(c);var n=a[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+o+": "+s+")",d.name="ChunkLoadError",d.type=o,d.request=s,n[1](d)}a[e]=void 0}};var c=setTimeout((function(){s({type:"timeout",target:i})}),12e4);i.onerror=i.onload=s,document.head.appendChild(i)}return Promise.all(t)},l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var i=window.webpackJsonp=window.webpackJsonp||[],d=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var r=d;s.push(["zUnb",0]),n()}({"7hEL":function(e,t,n){"use strict";n.r(t),t.default=n.p+"da7740faec2065d0c0e2432480abd6a2.xml"},WfoH:function(e,t){e.exports='<div id="game_info_dialog"> <header>Game metadata</header> <table> <tr> <td>Game name</td> <td><input id="game_info_dialog_name"></td> </tr> <tr> <td>Autor</td> <td><input id="game_info_dialog_author"></td> </tr> <tr> <td>Version</td> <td><input id="game_info_dialog_version"></td> </tr> </table> <button id="game_info_dialog_ok">OK</button> <button id="game_info_dialog_cancel">Cancel</button> </div>'},zUnb:function(e,t,n){"use strict";n.r(t);var o=n("t/1s"),a=(n("SdJ3"),n("90VE"));n("pmO8");function s(e,t,n){o.Blocks[e]={init:function(){t(this)}},o.Lua[e]=n}function l(e,t){return t.appendValueInput("TEXT").appendField(e).setCheck(["String"]),t.setNextStatement(!0),t.setPreviousStatement(!0),t}function i(e,t,n="TEXT"){return`${e} = ${o.Lua.valueToCode(t,n,o.Lua.ORDER_NONE)}`}function d(e,t){return t.appendValueInput("ITEMS").appendField(e).setCheck(["Array"]),t.setNextStatement(!0),t.setPreviousStatement(!0),t}s("instead_disp",e=>l("–ê–ª—å—Ç. –∏–º—è (disp)",e).setStyle("properties_blocks"),e=>i("disp",e)),s("instead_decor",e=>l("–î–µ–∫–æ—Ä–∞—Ü–∏–∏ (decor)",e).setStyle("properties_blocks"),e=>i("decor",e)),s("instead_inv",e=>l("–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å(inv) üéí",e).setStyle("properties_blocks"),e=>i("inv",e)),s("instead_act",e=>l("–î–µ–π—Å—Ç–≤–∏–µ(act) üîç",e).setStyle("properties_blocks"),e=>i("act",e)),s("instead_tak",e=>l("–í–∑—è–ª–∏(tak) üì¶",e).setStyle("properties_blocks"),e=>i("tak",e)),s("instead_used",e=>l("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ(used) üîó",e).setStyle("properties_blocks"),e=>i("used",e)),s("instead_use",e=>l("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ(use) üî®",e).setStyle("properties_blocks"),e=>i("use",e)),s("instead_onenter",e=>l("–ü—Ä–∏ –≤—Ö–æ–¥–µ (onenter)",e).setStyle("properties_blocks"),e=>i("onenter",e)),s("instead_onexit",e=>l("–ü—Ä–∏ –≤—ã—Ö–æ–¥–µ (onexit)",e).setStyle("properties_blocks"),e=>i("onexit",e)),s("instead_obj",e=>d("–û–±—ä–µ–∫—Ç—ã (obj)",e).setStyle("rooms_blocks"),e=>i("obj",e,"ITEMS")),s("instead_way",e=>d("–í—ã—Ö–æ–¥—ã (way)",e).setStyle("rooms_blocks"),e=>i("way",e,"ITEMS")),s("instead_return_false",e=>{e.appendDummyInput().appendField("–æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ"),e.setPreviousStatement(!0),e.setStyle("logic_blocks")},e=>"return false\n");s("instead_self",e=>{e.appendDummyInput().appendField("—Å–µ–±—è"),e.setOutput(!0,["InsteadObject","InsteadRoom"]),e.setStyle("procedure_blocks")},e=>["self",o.Lua.ORDER_ATOMIC]);function c(e,t){const n=t.getFieldValue("NAME"),a=o.Lua.valueToCode(t,"DSC",o.Lua.ORDER_NONE);let s=e+" {\n"+o.Lua.INDENT+"nam = "+o.Lua.quote_(n);a&&"''"!==a&&(s+=",\n"+o.Lua.prefixLines("dsc = "+a,o.Lua.INDENT));let l=!1;for(let e=t.getInputTargetBlock("DEFINITION");e;e=e.getNextBlock()){const t=o.Lua.blockToCode(e,!0);if("string"!=typeof t)throw TypeError("Expecting code from statement block: "+(e&&e.type));t&&(l=!0,s+=",\n"+o.Lua.prefixLines(t,o.Lua.INDENT))}return l&&(s+="\n"),s+="}",s}function r(e,t){return t.appendDummyInput().appendField(e).appendField(new o.FieldTextInput(e),"NAME"),t.appendValueInput("DSC").appendField("–û–ø–∏—Å–∞–Ω–∏–µ(dsc): ").setCheck("String"),t.appendStatementInput("DEFINITION"),t}function u(e,t,n){return e.appendDummyInput().appendField(new f(t),"NAME"),e.setOutput(!0,[n]),e}function p(e,t){let n=!0;for(let t=e.parentBlock_;t;t=t.parentBlock_)"lists_create_with"===t.type&&(n=!1);let a="";return n&&(a="_"),a+=o.Lua.quote_(t.getInsteadObjectName(e.getFieldValue("NAME"))),[a,o.Lua.ORDER_ATOMIC]}s("instead_what",e=>{e.appendDummyInput().appendField("–æ–±—ä–µ–∫—Ç"),e.setOutput(!0,["InsteadObject","InsteadRoom"]),e.setStyle("procedure_blocks")},e=>["what",o.Lua.ORDER_ATOMIC]);class b{constructor(e){this.objectsList=[["",""]],this.type=e}clear(){this.objectsList.length=0,this.objectsList.push(["",""])}objectLifecycleListener(e){if(!e.recordUndo)return;const t=e.getEventWorkspace_();if(e.type===o.Events.BLOCK_CREATE){const n=t.getBlockById(e.blockId);if(n.type!==this.type)return;this.addInsteadObject(e.blockId,n.getFieldValue("NAME")),this.refreshReferences(t,n.id)}else if(e.type===o.Events.BLOCK_CHANGE){if("field"!==e.element||"NAME"!==e.name)return;const n=t.getBlockById(e.blockId);if(n.type!==this.type)return;const o=this.findInsteadObject(e.blockId,!0);this.objectsList[o][0]=n.getFieldValue("NAME"),this.refreshReferences(t,n.id)}else e.type===o.Events.BLOCK_DELETE&&this.removeInsteadObject(e.blockId,t)}addInsteadObject(e,t){const n=this.findInsteadObject(e,!1);n>=0?!this.objectsList[n][0]&&t&&(this.objectsList[n][0]=t):(1!==this.objectsList.length||this.objectsList[0][1]||this.objectsList.pop(),this.objectsList.push([t,e]))}removeInsteadObject(e,t){const n=this.findInsteadObject(e,!1);if(n<0)return;this.objectsList.splice(n,1),0===this.objectsList.length&&this.objectsList.push(["",""]);t.getBlocksByType(this.type+"_ref",!1).forEach(t=>{t.getFieldValue("NAME")===e&&t.dispose(!0)})}findInsteadObject(e,t){const n=this.objectsList.findIndex(t=>t[1]===e);if(t&&n<0)throw TypeError("Object "+this.type+" with id "+e+" not found");return n}getInsteadObjectName(e){const t=this.findInsteadObject(e,!0);return this.objectsList[t][0]}refreshReferences(e,t){e.getBlocksByType(this.type+"_ref",!1).forEach(e=>{const n=e.getField("NAME");n.getValue()===t&&n.forceRerender()})}}const m=new b("instead_object");o.Blocks.instead_object={init:function(){r("–û–±—ä–µ–∫—Ç",this).setStyle("objects_blocks")}},o.Lua.instead_object=function(e){return c("obj",e)};class f extends o.FieldDropdown{constructor(e){super(e.objectsList),this.objectsContainer=e}fromXml(e){const t=e.textContent;this.objectsContainer.addInsteadObject(t,""),this.setValue(t)}}o.Blocks.instead_object_ref={init:function(){u(this,m,"InsteadObject").setStyle("objects_blocks")}},o.Lua.instead_object_ref=function(e){return p(e,m)};const h=new b("instead_room");function y(e,t,n){s(e,e=>{e.appendDummyInput().appendField(t),e.appendStatementInput("DEFINITION"),e.setOutput(!0,["String"]),e.setStyle("procedure_blocks")},e=>{const t=o.Lua.statementToCode(e,"DEFINITION");return[`function(${n})\n${t}end`,o.Lua.ORDER_HIGH]})}function _(e,t,n){s(e,e=>{e.appendValueInput("WHAT").appendField(t).setCheck(["InsteadObject"]),e.setNextStatement(!0),e.setPreviousStatement(!0),e.setStyle("actions_blocks")},e=>`${n}(${o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)})\n`)}function k(e,t,n,a){s(e,e=>{e.appendValueInput("WHAT").appendField(t).setCheck(["InsteadObject"]),e.appendValueInput("WHERE").appendField(a).setCheck(["InsteadObject","InsteadRoom"]),e.setNextStatement(!0),e.setPreviousStatement(!0),e.setStyle("actions_blocks")},e=>{let t=o.Lua.valueToCode(e,"WHERE",o.Lua.ORDER_NONE);return t=t?", "+t:"",`${n}(${o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)}${t})\n`})}o.Blocks.instead_room={init:function(){r("–ö–æ–º–Ω–∞—Ç–∞",this).setStyle("rooms_blocks")}},o.Lua.instead_room=function(e){return c("room",e)},o.Blocks.instead_room_ref={init:function(){u(this,h,"InsteadRoom").setStyle("rooms_blocks")}},o.Lua.instead_room_ref=function(e){return p(e,h)},y("instead_method0","ùëì","self"),y("instead_method1","ùëì (w)","self, what"),_("instead_take","–≤–∑—è—Ç—å(take): ","take"),_("instead_disable","–≤—ã–∫–ª—é—á–∏—Ç—å(disable): ","disable"),_("instead_enable","–≤–∫–ª—é—á–∏—Ç—å(enable): ","enable"),k("instead_drop","–±—Ä–æ—Å–∏—Ç—å(drop): ","drop","–≤"),k("instead_remove","—É–±—Ä–∞—Ç—å(remove): ","remove","–∏–∑"),o.Blocks.instead_where={init:function(){this.appendValueInput("WHAT").appendField("(where)").setCheck("InsteadObject"),this.appendDummyInput().appendField(new o.FieldDropdown([["‚àà","=="],["‚àâ","~="]]),"COND"),this.appendValueInput("WHERE").setCheck(["InsteadRoom","InsteadObject"]),this.setOutput(!0,["Boolean"]),this.setInputsInline(!0),this.setStyle("logic_blocks")}},o.Lua.instead_where=function(e){const t=e.getFieldValue("COND");return["where("+o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)+") "+t+" "+o.Lua.valueToCode(e,"WHERE",o.Lua.ORDER_NONE),o.Lua.ORDER_ATOMIC]},s("instead_print",e=>{e.appendDummyInput().appendField(new o.FieldDropdown([["ùëù","p"],["ùëùùëü","pr"],["ùëùùëõ","pn"]]),"FUN").appendField(new o.FieldTextInput,"TEXT"),e.setNextStatement(!0),e.setPreviousStatement(!0),e.setStyle("text_blocks")},e=>`${e.getFieldValue("FUN")}(${o.Lua.quote_(e.getFieldValue("TEXT"))})\n`),s("instead_rnd",e=>{e.appendValueInput("FROM").appendField("—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç").setCheck("Number"),e.appendValueInput("TO").appendField("–¥–æ").setCheck("Number"),e.setStyle("math_blocks"),e.setInputsInline(!0),e.setOutput(!0,["Number"])},e=>{let t=o.Lua.valueToCode(e,"FROM",o.Lua.ORDER_NONE)||"";return t&&(t+=", "),[`rnd(${t}${o.Lua.valueToCode(e,"TO",o.Lua.ORDER_NONE)})`,o.Lua.ORDER_HIGH]});var v=n("xOOu"),g=n("Iab2"),w=function(e,t,n,o){return new(n||(n=Promise))((function(a,s){function l(e){try{d(o.next(e))}catch(e){s(e)}}function i(e){try{d(o.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}d((o=o.apply(e,t||[])).next())}))};var T=function(e,t,n,o){return new(n||(n=Promise))((function(a,s){function l(e){try{d(o.next(e))}catch(e){s(e)}}function i(e){try{d(o.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}d((o=o.apply(e,t||[])).next())}))};function E(e){try{o.Events.disable(),e.clear(),m.clear(),h.clear()}finally{o.Events.enable()}}function I(e,t){return T(this,void 0,void 0,(function*(){const a=t.insteadMeta;let s=`-- $Name: ${a.name}$\n-- $Version: ${a.version}$\n-- $Author: ${a.author}$\n`;s+=o.Lua.workspaceToCode(t);const l=document.getElementById("generatedCode");if(l.innerText=s,e){(yield Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"T1M+"))).runGame(s)}else l.scrollIntoView()}))}function O(e,t){var n,a,s;try{const l=o.Xml.textToDom(e);E(t),t.insteadMeta={name:"Playground",version:"0.0",author:"Unknown"};for(let e,o=0;e=l.childNodes[o];o++)if("instead"==e.nodeName){const o=e.attributes,l={name:(null===(n=o.getNamedItem("name"))||void 0===n?void 0:n.textContent)||"",version:(null===(a=o.getNamedItem("version"))||void 0===a?void 0:a.textContent)||"",author:(null===(s=o.getNamedItem("author"))||void 0===s?void 0:s.textContent)||""};t.insteadMeta=l;break}o.Xml.domToWorkspace(l,t),console.log("Loaded workspace")}catch(e){const n="Failed to load workspace: "+e;console.log(n),alert(n),E(t)}}function N(e){const t=o.Xml.workspaceToDom(e),n=e.insteadMeta,a=document.createElement("instead");a.setAttribute("name",n.name),a.setAttribute("version",n.version),a.setAttribute("author",n.author),t.append(a);return o.Xml.domToText(t)}const L="</category>";function j(e,t){return`<category name="${e}" categorystyle="${t}">`}o.setLocale(a);const x=o.inject("blocklyDiv",{toolbox:function(){const e=['<xml style="display: none">',j("–û–±—ä–µ–∫—Ç—ã","objects_category"),'<block type="instead_object"> <value name="DSC"> <shadow type="text"> <field name="TEXT">–ó–¥–µ—Å—å –ª–µ–∂–∏—Ç –æ–±—ä–µ–∫—Ç.</field> </shadow> </value> </block> <block type="instead_disp"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–Ω–∞–∑–≤–∞–Ω–∏–µ</field> </shadow> </value> </block> <block type="instead_inv"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">—É –º–µ–Ω—è –µ—Å—Ç—å –æ–±—ä–µ–∫—Ç</field> </shadow> </value> </block> <block type="instead_act"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –æ–±—ä–µ–∫—Ç</field> </shadow> </value> </block> <block type="instead_tak"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–í—ã –≤–∑—è–ª–∏ "–æ–±—ä–µ–∫—Ç"</field> </shadow> </value> </block> <block type="instead_used"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ "what" –Ω–∞ –æ–±—ä–µ–∫—Ç</field> </shadow> </statement> </block> </value> </block> <block type="instead_use"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–µ–±—è –Ω–∞ "what"</field> </shadow> </statement> </block> </value> </block> <sep></sep> <block type="instead_method0"></block> <block type="instead_method1"></block> ',L,j("–ö–æ–º–Ω–∞—Ç—ã","rooms_category"),'<block type="instead_room"> <value name="DSC"> <shadow type="text"> <field name="TEXT">–í—ã –≤ –±–æ–ª—å—à–æ–π –∫–æ–º–Ω–∞—Ç–µ.</field> </shadow> </value> <statement name="DEFINITION"> <block type="instead_obj"></block> </statement> </block> <block type="instead_disp"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–Ω–∞–∑–≤–∞–Ω–∏–µ</field> </shadow> </value> </block> <block type="instead_decor"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã</field> </shadow> </value> </block> <block type="instead_obj"></block> <block type="instead_way"></block> <block type="instead_onenter"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤–æ—à–ª–∏ –≤ "what"</field> </shadow> </statement> </block> </value> </block> <block type="instead_onexit"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤—ã—Ö–æ–¥–∏—Ç–µ –≤ "what"</field> </shadow> </statement> </block> </value> </block> <sep></sep> <block type="instead_method0"></block> <block type="instead_method1"></block> <block type="lists_create_with"></block> ',L,j("–î–µ–π—Å—Ç–≤–∏—è","actions_category"),'<label text="–¢–µ–∫—Å—Ç"></label> <block type="instead_print"></block> <block type="text"></block> <block type="text_multiline"></block> <label text="–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –Ω–∞–¥ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏"></label> <block type="instead_take"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_drop"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_remove"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_disable"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_enable"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <label text="–ü–∞—Ä–∞–º–µ—Ç—Ä –¥–µ–π—Å—Ç–≤–∏—è"></label> <block type="instead_self"></block> <block type="instead_what"></block> <block type="instead_object_ref"></block> <block type="instead_room_ref"></block> ',L,j("–£—Å–ª–æ–≤–∏—è","logic_category"),'<block type="controls_if"></block> <block type="logic_compare"></block> <block type="logic_operation"></block> <block type="logic_negate"></block> <block type="logic_boolean"></block> <block type="instead_where"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_return_false"></block> <block type="instead_self"></block> <block type="instead_what"></block> <block type="instead_object_ref"></block> <block type="instead_room_ref"></block> ',L,j("–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","math_category"),'<block type="math_number"> <field name="NUM">42</field> </block> <block type="math_arithmetic"> <value name="A"> <shadow type="math_number"> <field name="NUM">1</field> </shadow> </value> <value name="B"> <shadow type="math_number"> <field name="NUM">1</field> </shadow> </value> </block> <block type="math_single"> <value name="NUM"> <shadow type="math_number"> <field name="NUM">9</field> </shadow> </value> </block> <block type="math_trig"> <value name="NUM"> <shadow type="math_number"> <field name="NUM">45</field> </shadow> </value> </block> <block type="math_constant"></block> <block type="math_number_property"> <value name="NUMBER_TO_CHECK"> <shadow type="math_number"> <field name="NUM">0</field> </shadow> </value> </block> <block type="math_round"> <value name="NUM"> <shadow type="math_number"> <field name="NUM">3.1</field> </shadow> </value> </block> <block type="math_modulo"> <value name="DIVIDEND"> <shadow type="math_number"> <field name="NUM">64</field> </shadow> </value> <value name="DIVISOR"> <shadow type="math_number"> <field name="NUM">10</field> </shadow> </value> </block> <block type="math_constrain"> <value name="VALUE"> <shadow type="math_number"> <field name="NUM">50</field> </shadow> </value> <value name="LOW"> <shadow type="math_number"> <field name="NUM">1</field> </shadow> </value> <value name="HIGH"> <shadow type="math_number"> <field name="NUM">100</field> </shadow> </value> </block> <block type="instead_rnd"> <value name="TO"> <shadow type="math_number"> <field name="NUM">42</field> </shadow> </value> </block> ',L,"<sep></sep>",'<category name="File" colour="215"> <button text="Edit game metadata" callbackKey="editMetadata"></button> <button text="Show Lua code" callbackKey="convertToLua"></button> <button text="Run" callbackKey="run"></button> <button text="Save in browser" callbackKey="save"></button> <sep></sep> <button text="Save to your computer" callbackKey="download"></button> <button text="Load from your computer" callbackKey="upload"></button> </category> '];return e.push("</xml>"),e.join("")}(),theme:o.Theme.defineTheme("instead",{base:"classic",categoryStyles:{rooms_category:{colour:"120"},objects_category:{colour:"60"},actions_category:{colour:"120"}},blockStyles:{rooms_blocks:{colourPrimary:"120"},objects_blocks:{colourPrimary:"60"},actions_blocks:{colourPrimary:"120"},properties_blocks:{colourPrimary:"30"}}}),move:{scrollbars:!0,wheel:!0},zoom:{controls:!0}});var S;if((S=x).registerButtonCallback("convertToLua",e=>{I(!1,e.getTargetWorkspace())}),S.registerButtonCallback("run",e=>{I(!0,e.getTargetWorkspace())}),S.registerButtonCallback("save",e=>{!function(e){const t=N(e);console.log("Saving text: "+t),window.localStorage.setItem("instead-data",t)}(e.getTargetWorkspace())}),S.registerButtonCallback("download",e=>{!function(e){T(this,void 0,void 0,(function*(){const t=new v,n=e.insteadMeta.name,a=N(e);t.file(n+"/blocks/main3.xml",a);const s=o.Lua.workspaceToCode(e);t.file(n+"/main3.lua",s);const l=yield t.generateAsync({type:"blob"});Object(g.saveAs)(l,n+".zip")}))}(e.getTargetWorkspace())}),S.registerButtonCallback("upload",e=>{(function(e){const t=document.getElementById("FileUploadInput");if(t)return t;const n=document.createElement("input");return n.accept=".zip",n.type="file",n.style.display="none",n.id="FileUploadInput",n.onchange=t=>{let n=t.target;if(!n.files)return;const o=new FileReader;o.onload=function(){n.value="",function(e,t){T(this,void 0,void 0,(function*(){const n=(yield v.loadAsync(t)).file(new RegExp("blocks/main3.xml$"))[0];n?O(yield n.async("string"),e):alert("Can't find blocks definition")}))}(e,this.result)},o.readAsArrayBuffer(n.files[0])},document.body.appendChild(n),n})(e.getTargetWorkspace()).click()}),S.registerButtonCallback("editMetadata",e=>{!function(e){T(this,void 0,void 0,(function*(){const t=e.insteadMeta,o=yield function(e){return w(this,void 0,void 0,(function*(){const t=document.createElement("div"),o=t.style;o.position="absolute",o.top="0",o.left="0",o.right="0",o.bottom="0",o.backgroundColor="rgba(0, 0, 0, .7)",o.zIndex="100",o.display="block";try{document.body.appendChild(t),t.innerHTML=n("WfoH");const o=document.getElementById("game_info_dialog_ok"),a=document.getElementById("game_info_dialog_cancel"),s=document.getElementById("game_info_dialog_name"),l=document.getElementById("game_info_dialog_author"),i=document.getElementById("game_info_dialog_version");return e&&(s.value=e.name,l.value=e.author,i.value=e.version),yield new Promise((e,t)=>{o.onclick=t=>{e({name:s.value,author:l.value,version:i.value})},a.onclick=t=>{e()}})}finally{t.remove()}}))}(t);o&&(e.insteadMeta=o)}))}(e.getTargetWorkspace())}),x.addChangeListener(e=>{m.objectLifecycleListener(e)}),x.addChangeListener(e=>{h.objectLifecycleListener(e)}),window.localStorage["instead-data"])console.log("Loading saved workspace"),O(window.localStorage["instead-data"],x);else{console.log("Loading default workspace");const e=n("7hEL").default,t=new XMLHttpRequest;t.onreadystatechange=function(){this.readyState===this.DONE&&200===this.status&&O(this.responseText,x)},t.open("GET",e,!0),t.send()}}});
//# sourceMappingURL=main.922801afdaa0b2bff9a6.js.map