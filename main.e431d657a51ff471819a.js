!function(e){function t(t){for(var o,i,l=t[0],c=t[1],d=t[2],u=0,p=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(r&&r(t);p.length;)p.shift()();return s.push.apply(s,d||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,l=1;l<n.length;l++){var c=n[l];0!==a[c]&&(o=!1)}o&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},a={2:0},s=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=o);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=function(e){return i.p+""+({1:"instead-js"}[e]||e)+"."+{1:"8e11af2e6fedd5320fc7"}[e]+".js"}(e);var c=new Error;s=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+s+")",c.name="ChunkLoadError",c.type=o,c.request=s,n[1](c)}a[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:l})}),12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var r=c;s.push(["zUnb",0]),n()}({"7hEL":function(e,t,n){"use strict";n.r(t),t.default=n.p+"da7740faec2065d0c0e2432480abd6a2.xml"},WfoH:function(e,t){e.exports='<div id="game_info_dialog"> <header>Game metadata</header> <table> <tr> <td>Game name</td> <td><input id="game_info_dialog_name"></td> </tr> <tr> <td>Autor</td> <td><input id="game_info_dialog_author"></td> </tr> <tr> <td>Version</td> <td><input id="game_info_dialog_version"></td> </tr> </table> <button id="game_info_dialog_ok">OK</button> <button id="game_info_dialog_cancel">Cancel</button> </div>'},zUnb:function(e,t,n){"use strict";n.r(t);var o=n("t/1s"),a=(n("SdJ3"),n("90VE"));n("pmO8");function s(e,t,n){o.Blocks[e]={init:function(){t(this)}},o.Lua[e]=n}function i(e,t){return t.appendValueInput("TEXT").appendField(e).setCheck(["String"]),t.setNextStatement(!0),t.setPreviousStatement(!0),t}function l(e,t,n="TEXT"){return`${e} = ${o.Lua.valueToCode(t,n,o.Lua.ORDER_NONE)}`}function c(e,t){return t.appendValueInput("ITEMS").appendField(e).setCheck(["Array"]),t.setNextStatement(!0),t.setPreviousStatement(!0),t}s("instead_disp",e=>i("–ê–ª—å—Ç. –∏–º—è (disp)",e).setStyle("properties_blocks"),e=>l("disp",e)),s("instead_decor",e=>i("–î–µ–∫–æ—Ä–∞—Ü–∏–∏ (decor)",e).setStyle("properties_blocks"),e=>l("decor",e)),s("instead_inv",e=>i("–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å(inv) üéí",e).setStyle("properties_blocks"),e=>l("inv",e)),s("instead_act",e=>i("–î–µ–π—Å—Ç–≤–∏–µ(act) üîç",e).setStyle("properties_blocks"),e=>l("act",e)),s("instead_used",e=>i("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ(used) üîó",e).setStyle("properties_blocks"),e=>l("used",e)),s("instead_use",e=>i("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ(use) üî®",e).setStyle("properties_blocks"),e=>l("use",e)),s("instead_onenter",e=>i("–ü—Ä–∏ –≤—Ö–æ–¥–µ (onenter)",e).setStyle("properties_blocks"),e=>l("onenter",e)),s("instead_onexit",e=>i("–ü—Ä–∏ –≤—ã—Ö–æ–¥–µ (onexit)",e).setStyle("properties_blocks"),e=>l("onexit",e)),s("instead_obj",e=>c("–û–±—ä–µ–∫—Ç—ã (obj)",e).setStyle("rooms_blocks"),e=>l("obj",e,"ITEMS")),s("instead_way",e=>c("–í—ã—Ö–æ–¥—ã (way)",e).setStyle("rooms_blocks"),e=>l("way",e,"ITEMS")),s("instead_return_false",e=>{e.appendDummyInput().appendField("–æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ"),e.setPreviousStatement(!0),e.setStyle("logic_blocks")},e=>"return false\n");s("instead_self",e=>{e.appendDummyInput().appendField("—Å–µ–±—è"),e.setOutput(!0,["InsteadObject","InsteadRoom"]),e.setStyle("procedure_blocks")},e=>["self",o.Lua.ORDER_ATOMIC]);function d(e,t){const n=t.getFieldValue("NAME"),a=o.Lua.valueToCode(t,"DSC",o.Lua.ORDER_NONE);let s=e+" {\n"+o.Lua.INDENT+"nam = "+o.Lua.quote_(n);a&&"''"!==a&&(s+=",\n"+o.Lua.prefixLines("dsc = "+a,o.Lua.INDENT));let i=!1;for(let e=t.getInputTargetBlock("DEFINITION");e;e=e.getNextBlock()){const t=o.Lua.blockToCode(e,!0);if("string"!=typeof t)throw TypeError("Expecting code from statement block: "+(e&&e.type));t&&(i=!0,s+=",\n"+o.Lua.prefixLines(t,o.Lua.INDENT))}return i&&(s+="\n"),s+="}",s}function r(e,t){return t.appendDummyInput().appendField(e).appendField(new o.FieldTextInput(e),"NAME"),t.appendValueInput("DSC").appendField("–û–ø–∏—Å–∞–Ω–∏–µ(dsc): ").setCheck("String"),t.appendStatementInput("DEFINITION"),t}function u(e,t,n){return e.appendDummyInput().appendField(new m(t),"NAME"),e.setOutput(!0,[n]),e}function p(e,t){let n=!0;for(let t=e.parentBlock_;t;t=t.parentBlock_)"lists_create_with"===t.type&&(n=!1);let a="";return n&&(a="_"),a+=o.Lua.quote_(t.getInsteadObjectName(e.getFieldValue("NAME"))),[a,o.Lua.ORDER_ATOMIC]}s("instead_what",e=>{e.appendDummyInput().appendField("–æ–±—ä–µ–∫—Ç"),e.setOutput(!0,["InsteadObject","InsteadRoom"]),e.setStyle("procedure_blocks")},e=>["what",o.Lua.ORDER_ATOMIC]);class b{constructor(e){this.objectsList=[["",""]],this.type=e}clear(){this.objectsList.length=0,this.objectsList.push(["",""])}objectLifecycleListener(e){if(!e.recordUndo)return;const t=e.getEventWorkspace_();if(e.type===o.Events.BLOCK_CREATE){const n=t.getBlockById(e.blockId);if(n.type!==this.type)return;this.addInsteadObject(e.blockId,n.getFieldValue("NAME")),this.refreshReferences(t,n.id)}else if(e.type===o.Events.BLOCK_CHANGE){if("field"!==e.element||"NAME"!==e.name)return;const n=t.getBlockById(e.blockId);if(n.type!==this.type)return;const o=this.findInsteadObject(e.blockId,!0);this.objectsList[o][0]=n.getFieldValue("NAME"),this.refreshReferences(t,n.id)}else e.type===o.Events.BLOCK_DELETE&&this.removeInsteadObject(e.blockId,t)}addInsteadObject(e,t){const n=this.findInsteadObject(e,!1);n>=0?!this.objectsList[n][0]&&t&&(this.objectsList[n][0]=t):(1!==this.objectsList.length||this.objectsList[0][1]||this.objectsList.pop(),this.objectsList.push([t,e]))}removeInsteadObject(e,t){const n=this.findInsteadObject(e,!1);if(n<0)return;this.objectsList.splice(n,1),0===this.objectsList.length&&this.objectsList.push(["",""]);t.getBlocksByType(this.type+"_ref",!1).forEach(t=>{t.getFieldValue("NAME")===e&&t.dispose(!0)})}findInsteadObject(e,t){const n=this.objectsList.findIndex(t=>t[1]===e);if(t&&n<0)throw TypeError("Object "+this.type+" with id "+e+" not found");return n}getInsteadObjectName(e){const t=this.findInsteadObject(e,!0);return this.objectsList[t][0]}refreshReferences(e,t){e.getBlocksByType(this.type+"_ref",!1).forEach(e=>{const n=e.getField("NAME");n.getValue()===t&&n.forceRerender()})}}const f=new b("instead_object");o.Blocks.instead_object={init:function(){r("–û–±—ä–µ–∫—Ç",this).setStyle("objects_blocks")}},o.Lua.instead_object=function(e){return d("obj",e)};class m extends o.FieldDropdown{constructor(e){super(e.objectsList),this.objectsContainer=e}fromXml(e){const t=e.textContent;this.objectsContainer.addInsteadObject(t,""),this.setValue(t)}}o.Blocks.instead_object_ref={init:function(){u(this,f,"InsteadObject").setStyle("objects_blocks")}},o.Lua.instead_object_ref=function(e){return p(e,f)};const h=new b("instead_room");o.Blocks.instead_room={init:function(){r("–ö–æ–º–Ω–∞—Ç–∞",this).setStyle("rooms_blocks")}},o.Lua.instead_room=function(e){return d("room",e)},o.Blocks.instead_room_ref={init:function(){u(this,h,"InsteadRoom").setStyle("rooms_blocks")}},o.Lua.instead_room_ref=function(e){return p(e,h)},o.Blocks.instead_method0={init:function(){this.jsonInit({message0:"ùëì %1",args0:[{type:"input_statement",name:"DEFINITION"}],output:["String"]}),this.setStyle("procedure_blocks")}},o.Lua.instead_method0=function(e){return["function(self)\n"+o.Lua.statementToCode(e,"DEFINITION")+"end",o.Lua.ORDER_HIGH]},o.Blocks.instead_method1={init:function(){this.jsonInit({message0:"ùëì (w) %1",args0:[{type:"input_statement",name:"DEFINITION"}],output:["String"]}),this.setStyle("procedure_blocks")}},o.Lua.instead_method1=function(e){return["function(self, what)\n"+o.Lua.statementToCode(e,"DEFINITION")+"end",o.Lua.ORDER_HIGH]},o.Blocks.instead_print={init:function(){this.appendDummyInput().appendField(new o.FieldDropdown([["ùëù","p"],["ùëùùëü","pr"],["ùëùùëõ","pn"]]),"FUN").appendField(new o.FieldTextInput,"TEXT"),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setStyle("text_blocks")}},o.Lua.instead_print=function(e){return e.getFieldValue("FUN")+"("+o.Lua.quote_(e.getFieldValue("TEXT"))+")\n"},o.Blocks.instead_take={init:function(){this.appendValueInput("WHAT").appendField("–≤–∑—è—Ç—å(take): ").setCheck("InsteadObject"),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setStyle("actions_blocks")}},o.Lua.instead_take=function(e){return"take("+o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)+")\n"},o.Blocks.instead_disable={init:function(){this.appendValueInput("WHAT").appendField("–≤—ã–∫–ª—é—á–∏—Ç—å(disable): ").setCheck(["InsteadObject"]),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setStyle("actions_blocks")}},o.Lua.instead_disable=function(e){return"disable("+o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)+")\n"},o.Blocks.instead_enable={init:function(){this.appendValueInput("WHAT").appendField("–≤–∫–ª—é—á–∏—Ç—å(enable): ").setCheck(["InsteadObject"]),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setStyle("actions_blocks")}},o.Lua.instead_enable=function(e){return"enable("+o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)+")\n"},o.Blocks.instead_drop={init:function(){this.appendValueInput("WHAT").appendField("–±—Ä–æ—Å–∏—Ç—å(drop): ").setCheck(["InsteadObject"]),this.appendValueInput("WHERE").appendField("–≤").setCheck(["InsteadObject"]),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setInputsInline(!0),this.setStyle("actions_blocks")}},o.Lua.instead_drop=function(e){const t=o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE),n=o.Lua.valueToCode(e,"WHERE",o.Lua.ORDER_NONE);let a="drop("+t;return n&&(a+=", "+n),a+=")\n",a},o.Blocks.instead_where={init:function(){this.appendValueInput("WHAT").appendField("(where)").setCheck("InsteadObject"),this.appendDummyInput().appendField(new o.FieldDropdown([["‚àà","=="],["‚àâ","~="]]),"COND"),this.appendValueInput("WHERE").setCheck(["InsteadRoom","InsteadObject"]),this.setOutput(!0,["Boolean"]),this.setInputsInline(!0),this.setStyle("logic_blocks")}},o.Lua.instead_where=function(e){const t=e.getFieldValue("COND");return["where("+o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)+") "+t+" "+o.Lua.valueToCode(e,"WHERE",o.Lua.ORDER_NONE),o.Lua.ORDER_ATOMIC]};var y=n("xOOu"),_=n("Iab2"),k=function(e,t,n,o){return new(n||(n=Promise))((function(a,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((o=o.apply(e,t||[])).next())}))};var g=function(e,t,n,o){return new(n||(n=Promise))((function(a,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((o=o.apply(e,t||[])).next())}))};function v(e){try{o.Events.disable(),e.clear(),f.clear(),h.clear()}finally{o.Events.enable()}}function T(e,t){return g(this,void 0,void 0,(function*(){const a=t.insteadMeta;let s=`-- $Name: ${a.name}$\n-- $Version: ${a.version}$\n-- $Author: ${a.author}$\n`;s+=o.Lua.workspaceToCode(t);const i=document.getElementById("generatedCode");if(i.innerText=s,e){(yield Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"T1M+"))).runGame(s)}else i.scrollIntoView()}))}function I(e,t){var n,a,s;try{const i=o.Xml.textToDom(e);v(t),t.insteadMeta={name:"Playground",version:"0.0",author:"Unknown"};for(let e,o=0;e=i.childNodes[o];o++)if("instead"==e.nodeName){const o=e.attributes,i={name:(null===(n=o.getNamedItem("name"))||void 0===n?void 0:n.textContent)||"",version:(null===(a=o.getNamedItem("version"))||void 0===a?void 0:a.textContent)||"",author:(null===(s=o.getNamedItem("author"))||void 0===s?void 0:s.textContent)||""};t.insteadMeta=i;break}o.Xml.domToWorkspace(i,t),console.log("Loaded workspace")}catch(e){const n="Failed to load workspace: "+e;console.log(n),alert(n),v(t)}}function E(e){const t=o.Xml.workspaceToDom(e),n=e.insteadMeta,a=document.createElement("instead");a.setAttribute("name",n.name),a.setAttribute("version",n.version),a.setAttribute("author",n.author),t.append(a);return o.Xml.domToText(t)}const w="</category>";function L(e,t){return`<category name="${e}" categorystyle="${t}">`}o.setLocale(a);const O=o.inject("blocklyDiv",{toolbox:function(){const e=['<xml style="display: none">',L("–û–±—ä–µ–∫—Ç—ã","objects_category"),'<block type="instead_object"> <value name="DSC"> <shadow type="text"> <field name="TEXT">–ó–¥–µ—Å—å –ª–µ–∂–∏—Ç –æ–±—ä–µ–∫—Ç.</field> </shadow> </value> </block> <block type="instead_disp"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–Ω–∞–∑–≤–∞–Ω–∏–µ</field> </shadow> </value> </block> <block type="instead_inv"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">—É –º–µ–Ω—è –µ—Å—Ç—å –æ–±—ä–µ–∫—Ç</field> </shadow> </value> </block> <block type="instead_act"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –æ–±—ä–µ–∫—Ç</field> </shadow> </value> </block> <block type="instead_used"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ "what" –Ω–∞ –æ–±—ä–µ–∫—Ç</field> </shadow> </statement> </block> </value> </block> <block type="instead_use"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–µ–±—è –Ω–∞ "what"</field> </shadow> </statement> </block> </value> </block> <sep></sep> <block type="instead_method0"></block> <block type="instead_method1"></block> ',w,L("–ö–æ–º–Ω–∞—Ç—ã","rooms_category"),'<block type="instead_room"> <value name="DSC"> <shadow type="text"> <field name="TEXT">–í—ã –≤ –±–æ–ª—å—à–æ–π –∫–æ–º–Ω–∞—Ç–µ.</field> </shadow> </value> <statement name="DEFINITION"> <block type="instead_obj"></block> </statement> </block> <block type="instead_disp"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–Ω–∞–∑–≤–∞–Ω–∏–µ</field> </shadow> </value> </block> <block type="instead_decor"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã</field> </shadow> </value> </block> <block type="instead_obj"></block> <block type="instead_way"></block> <block type="instead_onenter"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤–æ—à–ª–∏ –≤ "what"</field> </shadow> </statement> </block> </value> </block> <block type="instead_onexit"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">–≤—ã—Ö–æ–¥–∏—Ç–µ –≤ "what"</field> </shadow> </statement> </block> </value> </block> <sep></sep> <block type="instead_method0"></block> <block type="instead_method1"></block> <block type="lists_create_with"></block> ',w,L("–î–µ–π—Å—Ç–≤–∏—è","actions_category"),'<label text="–¢–µ–∫—Å—Ç"></label> <block type="instead_print"></block> <block type="text"></block> <block type="text_multiline"></block> <label text="–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –Ω–∞–¥ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏"></label> <block type="instead_take"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_drop"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_disable"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_enable"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <label text="–ü–∞—Ä–∞–º–µ—Ç—Ä –¥–µ–π—Å—Ç–≤–∏—è"></label> <block type="instead_self"></block> <block type="instead_what"></block> <block type="instead_object_ref"></block> <block type="instead_room_ref"></block> ',w,L("–£—Å–ª–æ–≤–∏—è","logic_category"),'<block type="controls_if"></block> <block type="logic_compare"></block> <block type="logic_operation"></block> <block type="logic_negate"></block> <block type="logic_boolean"></block> <block type="instead_where"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_return_false"></block> <block type="instead_self"></block> <block type="instead_what"></block> <block type="instead_object_ref"></block> <block type="instead_room_ref"></block> ',w,"<sep></sep>",'<category name="File" colour="215"> <button text="Edit game metadata" callbackKey="editMetadata"></button> <button text="Show Lua code" callbackKey="convertToLua"></button> <button text="Run" callbackKey="run"></button> <button text="Save in browser" callbackKey="save"></button> <sep></sep> <button text="Save to your computer" callbackKey="download"></button> <button text="Load from your computer" callbackKey="upload"></button> </category> '];return e.push("</xml>"),e.join("")}(),theme:o.Theme.defineTheme("instead",{base:"classic",categoryStyles:{rooms_category:{colour:"120"},objects_category:{colour:"60"},actions_category:{colour:"120"}},blockStyles:{rooms_blocks:{colourPrimary:"120"},objects_blocks:{colourPrimary:"60"},actions_blocks:{colourPrimary:"120"},properties_blocks:{colourPrimary:"30"}}}),move:{scrollbars:!0,wheel:!0},zoom:{controls:!0}});var j;if((j=O).registerButtonCallback("convertToLua",e=>{T(!1,e.getTargetWorkspace())}),j.registerButtonCallback("run",e=>{T(!0,e.getTargetWorkspace())}),j.registerButtonCallback("save",e=>{!function(e){const t=E(e);console.log("Saving text: "+t),window.localStorage.setItem("instead-data",t)}(e.getTargetWorkspace())}),j.registerButtonCallback("download",e=>{!function(e){g(this,void 0,void 0,(function*(){const t=new y,n=e.insteadMeta.name,a=E(e);t.file(n+"/blocks/main3.xml",a);const s=o.Lua.workspaceToCode(e);t.file(n+"/main3.lua",s);const i=yield t.generateAsync({type:"blob"});Object(_.saveAs)(i,n+".zip")}))}(e.getTargetWorkspace())}),j.registerButtonCallback("upload",e=>{(function(e){const t=document.getElementById("FileUploadInput");if(t)return t;const n=document.createElement("input");return n.accept=".zip",n.type="file",n.style.display="none",n.id="FileUploadInput",n.onchange=t=>{let n=t.target;if(!n.files)return;const o=new FileReader;o.onload=function(){n.value="",function(e,t){g(this,void 0,void 0,(function*(){const n=(yield y.loadAsync(t)).file(new RegExp("blocks/main3.xml$"))[0];n?I(yield n.async("string"),e):alert("Can't find blocks definition")}))}(e,this.result)},o.readAsArrayBuffer(n.files[0])},document.body.appendChild(n),n})(e.getTargetWorkspace()).click()}),j.registerButtonCallback("editMetadata",e=>{!function(e){g(this,void 0,void 0,(function*(){const t=e.insteadMeta,o=yield function(e){return k(this,void 0,void 0,(function*(){const t=document.createElement("div"),o=t.style;o.position="absolute",o.top="0",o.left="0",o.right="0",o.bottom="0",o.backgroundColor="rgba(0, 0, 0, .7)",o.zIndex="100",o.display="block";try{document.body.appendChild(t),t.innerHTML=n("WfoH");const o=document.getElementById("game_info_dialog_ok"),a=document.getElementById("game_info_dialog_cancel"),s=document.getElementById("game_info_dialog_name"),i=document.getElementById("game_info_dialog_author"),l=document.getElementById("game_info_dialog_version");return e&&(s.value=e.name,i.value=e.author,l.value=e.version),yield new Promise((e,t)=>{o.onclick=t=>{e({name:s.value,author:i.value,version:l.value})},a.onclick=t=>{e()}})}finally{t.remove()}}))}(t);o&&(e.insteadMeta=o)}))}(e.getTargetWorkspace())}),O.addChangeListener(e=>{f.objectLifecycleListener(e)}),O.addChangeListener(e=>{h.objectLifecycleListener(e)}),window.localStorage["instead-data"])console.log("Loading saved workspace"),I(window.localStorage["instead-data"],O);else{console.log("Loading default workspace");const e=n("7hEL").default,t=new XMLHttpRequest;t.onreadystatechange=function(){this.readyState===this.DONE&&200===this.status&&I(this.responseText,O)},t.open("GET",e,!0),t.send()}}});
//# sourceMappingURL=main.e431d657a51ff471819a.js.map