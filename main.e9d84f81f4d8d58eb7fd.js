!function(e){function t(t){for(var o,s,i=t[0],c=t[1],d=t[2],u=0,p=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(r&&r(t);p.length;)p.shift()();return l.push.apply(l,d||[]),n()}function n(){for(var e,t=0;t<l.length;t++){for(var n=l[t],o=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(o=!1)}o&&(l.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},a={2:0},l=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=o);var l,i=document.createElement("script");i.charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.src=function(e){return s.p+""+({1:"instead-js"}[e]||e)+"."+{1:"8e11af2e6fedd5320fc7"}[e]+".js"}(e);var c=new Error;l=function(t){i.onerror=i.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+l+")",c.name="ChunkLoadError",c.type=o,c.request=l,n[1](c)}a[e]=void 0}};var d=setTimeout((function(){l({type:"timeout",target:i})}),12e4);i.onerror=i.onload=l,document.head.appendChild(i)}return Promise.all(t)},s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var r=c;l.push(["zUnb",0]),n()}({"7hEL":function(e,t,n){"use strict";n.r(t),t.default=n.p+"da7740faec2065d0c0e2432480abd6a2.xml"},J6RI:function(e,t,n){"use strict";n.r(t);var o=n("JPst"),a=n.n(o),l=n("HeW1"),s=n.n(l),i=n("zVD3"),c=a()(!0),d=s()(i.a);c.push([e.i,".instead-logo {\n    background-image: url("+d+");\n}\n\n#blocklyDiv {\n    /* Header height */\n    height: calc(100vh - 60px - 24px);\n}\n\n#codeDiv {\n    /* Header height and tab header height */\n    height: calc(100vh - 60px - 24px - 36px);\n    overflow: auto;\n}\n\n#generatedCode {\n    white-space: pre;\n}\n\n/* Fix clr styles*/\n#stead-container pre {\n    border-style: none;\n    white-space: pre-line;\n}","",{version:3,sources:["webpack://src/style.css"],names:[],mappings:"AAAA;IACI,yDAAkD;AACtD;;AAEA;IACI,kBAAkB;IAClB,iCAAiC;AACrC;;AAEA;IACI,wCAAwC;IACxC,wCAAwC;IACxC,cAAc;AAClB;;AAEA;IACI,gBAAgB;AACpB;;AAEA,kBAAkB;AAClB;IACI,kBAAkB;IAClB,qBAAqB;AACzB",sourcesContent:['.instead-logo {\n    background-image: url("../public/sdl_instead.svg");\n}\n\n#blocklyDiv {\n    /* Header height */\n    height: calc(100vh - 60px - 24px);\n}\n\n#codeDiv {\n    /* Header height and tab header height */\n    height: calc(100vh - 60px - 24px - 36px);\n    overflow: auto;\n}\n\n#generatedCode {\n    white-space: pre;\n}\n\n/* Fix clr styles*/\n#stead-container pre {\n    border-style: none;\n    white-space: pre-line;\n}'],sourceRoot:""}]),t.default=c},OMi8:function(e,t,n){var o=n("LboF"),a=n("J6RI");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var l={insert:"head",singleton:!1};o(a,l);e.exports=a.locals||{}},WfoH:function(e,t){e.exports='<div class="modal" id="game_info_dialog"> <div class="modal-dialog" role="dialog" aria-hidden="true"> <div class="modal-content"> <div class="modal-header"> <h3 class="modal-title">Game metadata</h3> </div> <div class="modal-body"> <form class="clr-form"> <div class="clr-form-control"> <label for="game_info_dialog_name" class="clr-control-label">Game title</label> <div class="clr-control-container"> <div class="clr-input-wrapper"> <input id="game_info_dialog_name" class="clr-input"/> </div> <span class="clr-subtext">Game title as seen in the Instead</span> </div> </div> <div class="clr-form-control"> <label for="game_info_dialog_author" class="clr-control-label">Author</label> <div class="clr-control-container"> <div class="clr-input-wrapper"> <input id="game_info_dialog_author" class="clr-input"/> </div> <span class="clr-subtext">Author(s) of the game</span> </div> </div> <div class="clr-form-control"> <label for="game_info_dialog_version" class="clr-control-label">Version</label> <div class="clr-control-container"> <div class="clr-input-wrapper"> <input id="game_info_dialog_version" class="clr-input"/> </div> <span class="clr-subtext">Game version</span> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-outline" type="button" id="game_info_dialog_cancel">Cancel</button> <button class="btn btn-primary" type="button" id="game_info_dialog_ok">Ok</button> </div> </div> </div> </div> <div class="modal-backdrop" aria-hidden="true"></div>'},zUnb:function(e,t,n){"use strict";n.r(t);n("tVOP"),n("OMi8");var o=n("t/1s"),a=(n("SdJ3"),n("90VE"));n("pmO8");function l(e,t,n){o.Blocks[e]={init:function(){t(this)}},o.Lua[e]=n}function s(e,t){return t.appendValueInput("TEXT").appendField(e).setCheck(["String"]),t.setNextStatement(!0),t.setPreviousStatement(!0),t}function i(e,t,n="TEXT"){return`${e} = ${o.Lua.valueToCode(t,n,o.Lua.ORDER_NONE)}`}function c(e,t){return t.appendValueInput("ITEMS").appendField(e).setCheck(["Array"]),t.setNextStatement(!0),t.setPreviousStatement(!0),t}l("instead_disp",e=>s("Альт. имя (disp)",e).setStyle("properties_blocks"),e=>i("disp",e)),l("instead_decor",e=>s("Декорации (decor)",e).setStyle("properties_blocks"),e=>i("decor",e)),l("instead_inv",e=>s("Инвентарь(inv) 🎒",e).setStyle("properties_blocks"),e=>i("inv",e)),l("instead_act",e=>s("Действие(act) 🔍",e).setStyle("properties_blocks"),e=>i("act",e)),l("instead_tak",e=>s("Взяли(tak) 📦",e).setStyle("properties_blocks"),e=>i("tak",e)),l("instead_used",e=>s("Использование(used) 🔗",e).setStyle("properties_blocks"),e=>i("used",e)),l("instead_use",e=>s("Использование(use) 🔨",e).setStyle("properties_blocks"),e=>i("use",e)),l("instead_onenter",e=>s("При входе (onenter)",e).setStyle("properties_blocks"),e=>i("onenter",e)),l("instead_onexit",e=>s("При выходе (onexit)",e).setStyle("properties_blocks"),e=>i("onexit",e)),l("instead_obj",e=>c("Объекты (obj)",e).setStyle("rooms_blocks"),e=>i("obj",e,"ITEMS")),l("instead_way",e=>c("Выходы (way)",e).setStyle("rooms_blocks"),e=>i("way",e,"ITEMS")),l("instead_return_false",e=>{e.appendDummyInput().appendField("отменить действие"),e.setPreviousStatement(!0),e.setStyle("logic_blocks")},e=>"return false\n");l("instead_self",e=>{e.appendDummyInput().appendField("себя"),e.setOutput(!0,["InsteadObject","InsteadRoom"]),e.setStyle("procedure_blocks")},e=>["self",o.Lua.ORDER_ATOMIC]);function d(e,t){const n=t.getFieldValue("NAME"),a=o.Lua.valueToCode(t,"DSC",o.Lua.ORDER_NONE);let l=e+" {\n"+o.Lua.INDENT+"nam = "+o.Lua.quote_(n);a&&"''"!==a&&(l+=",\n"+o.Lua.prefixLines("dsc = "+a,o.Lua.INDENT));let s=!1;for(let e=t.getInputTargetBlock("DEFINITION");e;e=e.getNextBlock()){const t=o.Lua.blockToCode(e,!0);if("string"!=typeof t)throw TypeError("Expecting code from statement block: "+(e&&e.type));t&&(s=!0,l+=",\n"+o.Lua.prefixLines(t,o.Lua.INDENT))}return s&&(l+="\n"),l+="}",l}function r(e,t){return t.appendDummyInput().appendField(e).appendField(new o.FieldTextInput(e),"NAME"),t.appendValueInput("DSC").appendField("Описание(dsc): ").setCheck("String"),t.appendStatementInput("DEFINITION"),t}function u(e,t,n){return e.appendDummyInput().appendField(new h(t),"NAME"),e.setOutput(!0,[n]),e}function p(e,t){let n=!0;for(let t=e.parentBlock_;t;t=t.parentBlock_)"lists_create_with"===t.type&&(n=!1);let a="";return n&&(a="_"),a+=o.Lua.quote_(t.getInsteadObjectName(e.getFieldValue("NAME"))),[a,o.Lua.ORDER_ATOMIC]}l("instead_what",e=>{e.appendDummyInput().appendField("объект"),e.setOutput(!0,["InsteadObject","InsteadRoom"]),e.setStyle("procedure_blocks")},e=>["what",o.Lua.ORDER_ATOMIC]);class b{constructor(e){this.objectsList=[["",""]],this.type=e}clear(){this.objectsList.length=0,this.objectsList.push(["",""])}objectLifecycleListener(e){if(!e.recordUndo)return;const t=e.getEventWorkspace_();if(e.type===o.Events.BLOCK_CREATE){const n=t.getBlockById(e.blockId);if(n.type!==this.type)return;this.addInsteadObject(e.blockId,n.getFieldValue("NAME")),this.refreshReferences(t,n.id)}else if(e.type===o.Events.BLOCK_CHANGE){if("field"!==e.element||"NAME"!==e.name)return;const n=t.getBlockById(e.blockId);if(n.type!==this.type)return;const o=this.findInsteadObject(e.blockId,!0);this.objectsList[o][0]=n.getFieldValue("NAME"),this.refreshReferences(t,n.id)}else e.type===o.Events.BLOCK_DELETE&&this.removeInsteadObject(e.blockId,t)}addInsteadObject(e,t){const n=this.findInsteadObject(e,!1);n>=0?!this.objectsList[n][0]&&t&&(this.objectsList[n][0]=t):(1!==this.objectsList.length||this.objectsList[0][1]||this.objectsList.pop(),this.objectsList.push([t,e]))}removeInsteadObject(e,t){const n=this.findInsteadObject(e,!1);if(n<0)return;this.objectsList.splice(n,1),0===this.objectsList.length&&this.objectsList.push(["",""]);t.getBlocksByType(this.type+"_ref",!1).forEach(t=>{t.getFieldValue("NAME")===e&&t.dispose(!0)})}findInsteadObject(e,t){const n=this.objectsList.findIndex(t=>t[1]===e);if(t&&n<0)throw TypeError("Object "+this.type+" with id "+e+" not found");return n}getInsteadObjectName(e){const t=this.findInsteadObject(e,!0);return this.objectsList[t][0]}refreshReferences(e,t){e.getBlocksByType(this.type+"_ref",!1).forEach(e=>{const n=e.getField("NAME");n.getValue()===t&&n.forceRerender()})}}const m=new b("instead_object");o.Blocks.instead_object={init:function(){r("Объект",this).setStyle("objects_blocks")}},o.Lua.instead_object=function(e){return d("obj",e)};class h extends o.FieldDropdown{constructor(e){super(e.objectsList),this.objectsContainer=e}fromXml(e){const t=e.textContent;this.objectsContainer.addInsteadObject(t,""),this.setValue(t)}}o.Blocks.instead_object_ref={init:function(){u(this,m,"InsteadObject").setStyle("objects_blocks")}},o.Lua.instead_object_ref=function(e){return p(e,m)};const f=new b("instead_room");function y(e,t,n){l(e,e=>{e.appendDummyInput().appendField(t),e.appendStatementInput("DEFINITION"),e.setOutput(!0,["String"]),e.setStyle("procedure_blocks")},e=>{const t=o.Lua.statementToCode(e,"DEFINITION");return[`function(${n})\n${t}end`,o.Lua.ORDER_HIGH]})}function _(e,t,n){l(e,e=>{e.appendValueInput("WHAT").appendField(t).setCheck(["InsteadObject"]),e.setNextStatement(!0),e.setPreviousStatement(!0),e.setStyle("actions_blocks")},e=>`${n}(${o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)})\n`)}function k(e,t,n,a){l(e,e=>{e.appendValueInput("WHAT").appendField(t).setCheck(["InsteadObject"]),e.appendValueInput("WHERE").appendField(a).setCheck(["InsteadObject","InsteadRoom"]),e.setNextStatement(!0),e.setPreviousStatement(!0),e.setStyle("actions_blocks")},e=>{let t=o.Lua.valueToCode(e,"WHERE",o.Lua.ORDER_NONE);return t=t?", "+t:"",`${n}(${o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)}${t})\n`})}o.Blocks.instead_room={init:function(){r("Комната",this).setStyle("rooms_blocks")}},o.Lua.instead_room=function(e){return d("room",e)},o.Blocks.instead_room_ref={init:function(){u(this,f,"InsteadRoom").setStyle("rooms_blocks")}},o.Lua.instead_room_ref=function(e){return p(e,f)},y("instead_method0","𝑓","self"),y("instead_method1","𝑓 (w)","self, what"),_("instead_take","взять(take): ","take"),_("instead_disable","выключить(disable): ","disable"),_("instead_enable","включить(enable): ","enable"),k("instead_drop","бросить(drop): ","drop","в"),k("instead_remove","убрать(remove): ","remove","из"),o.Blocks.instead_where={init:function(){this.appendValueInput("WHAT").appendField("(where)").setCheck("InsteadObject"),this.appendDummyInput().appendField(new o.FieldDropdown([["∈","=="],["∉","~="]]),"COND"),this.appendValueInput("WHERE").setCheck(["InsteadRoom","InsteadObject"]),this.setOutput(!0,["Boolean"]),this.setInputsInline(!0),this.setStyle("logic_blocks")}},o.Lua.instead_where=function(e){const t=e.getFieldValue("COND");return["where("+o.Lua.valueToCode(e,"WHAT",o.Lua.ORDER_NONE)+") "+t+" "+o.Lua.valueToCode(e,"WHERE",o.Lua.ORDER_NONE),o.Lua.ORDER_ATOMIC]},l("instead_print",e=>{e.appendDummyInput().appendField(new o.FieldDropdown([["𝑝","p"],["𝑝𝑟","pr"],["𝑝𝑛","pn"]]),"FUN").appendField(new o.FieldTextInput,"TEXT"),e.setNextStatement(!0),e.setPreviousStatement(!0),e.setStyle("text_blocks")},e=>`${e.getFieldValue("FUN")}(${o.Lua.quote_(e.getFieldValue("TEXT"))})\n`),l("instead_rnd",e=>{e.appendValueInput("FROM").appendField("случайное число от").setCheck("Number"),e.appendValueInput("TO").appendField("до").setCheck("Number"),e.setStyle("math_blocks"),e.setInputsInline(!0),e.setOutput(!0,["Number"])},e=>{let t=o.Lua.valueToCode(e,"FROM",o.Lua.ORDER_NONE)||"";return t&&(t+=", "),[`rnd(${t}${o.Lua.valueToCode(e,"TO",o.Lua.ORDER_NONE)})`,o.Lua.ORDER_HIGH]});var v=n("xOOu"),g=n("Iab2"),w=function(e,t,n,o){return new(n||(n=Promise))((function(a,l){function s(e){try{c(o.next(e))}catch(e){l(e)}}function i(e){try{c(o.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}c((o=o.apply(e,t||[])).next())}))};var I=function(e,t,n,o){return new(n||(n=Promise))((function(a,l){function s(e){try{c(o.next(e))}catch(e){l(e)}}function i(e){try{c(o.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}c((o=o.apply(e,t||[])).next())}))};function T(e){try{o.Events.disable(),e.clear(),m.clear(),f.clear()}finally{o.Events.enable()}}function E(e,t){return I(this,void 0,void 0,(function*(){const a=t.insteadMeta;let l=`-- $Name: ${a.name}$\n-- $Version: ${a.version}$\n-- $Author: ${a.author}$\n`;l+=o.Lua.workspaceToCode(t);const s=document.getElementById("generatedCode");if(s.innerText=l,e){(yield Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"T1M+"))).runGame(l)}else{document.getElementById("codeButton").click(),s.scrollIntoView()}}))}function A(e,t){var n,a,l;try{const s=o.Xml.textToDom(e);T(t),t.insteadMeta={name:"Playground",version:"0.0",author:"Unknown"};for(let e,o=0;e=s.childNodes[o];o++)if("instead"==e.nodeName){const o=e.attributes,s={name:(null===(n=o.getNamedItem("name"))||void 0===n?void 0:n.textContent)||"",version:(null===(a=o.getNamedItem("version"))||void 0===a?void 0:a.textContent)||"",author:(null===(l=o.getNamedItem("author"))||void 0===l?void 0:l.textContent)||""};t.insteadMeta=s;break}o.Xml.domToWorkspace(s,t),console.log("Loaded workspace")}catch(e){const n="Failed to load workspace: "+e;console.log(n),alert(n),T(t)}}function O(e){const t=o.Xml.workspaceToDom(e),n=e.insteadMeta,a=document.createElement("instead");a.setAttribute("name",n.name),a.setAttribute("version",n.version),a.setAttribute("author",n.author),t.append(a);return o.Xml.domToText(t)}const N="</category>";function L(e,t){return`<category name="${e}" categorystyle="${t}">`}function C(e){const t=document.getElementById("preview-pane");if(!t)return;const n=t.getElementsByClassName("btn");for(let t,o=0;t=n[o];o++)o==e?t.classList.add("active"):t.classList.remove("active");const o=t.getElementsByTagName("section");for(let t,n=0;t=o[n];n++)n==e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}o.setLocale(a);const x=o.inject("blocklyDiv",{toolbox:function(){const e=['<xml style="display: none">',L("Объекты","objects_category"),'<block type="instead_object"> <value name="DSC"> <shadow type="text"> <field name="TEXT">Здесь лежит объект.</field> </shadow> </value> </block> <block type="instead_disp"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">название</field> </shadow> </value> </block> <block type="instead_inv"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">у меня есть объект</field> </shadow> </value> </block> <block type="instead_act"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">действие на объект</field> </shadow> </value> </block> <block type="instead_tak"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">Вы взяли "объект"</field> </shadow> </value> </block> <block type="instead_used"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">вы использовали "what" на объект</field> </shadow> </statement> </block> </value> </block> <block type="instead_use"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">вы использовали себя на "what"</field> </shadow> </statement> </block> </value> </block> <sep></sep> <block type="instead_method0"></block> <block type="instead_method1"></block> ',N,L("Комнаты","rooms_category"),'<block type="instead_room"> <value name="DSC"> <shadow type="text"> <field name="TEXT">Вы в большой комнате.</field> </shadow> </value> <statement name="DEFINITION"> <block type="instead_obj"></block> </statement> </block> <block type="instead_disp"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">название</field> </shadow> </value> </block> <block type="instead_decor"> <value name="TEXT"> <shadow type="text"> <field name="TEXT">Детальное описание комнаты</field> </shadow> </value> </block> <block type="instead_obj"></block> <block type="instead_way"></block> <block type="instead_onenter"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">вошли в "what"</field> </shadow> </statement> </block> </value> </block> <block type="instead_onexit"> <value name="TEXT"> <block type="instead_method1"> <statement name="DEFINITION"> <shadow type="instead_print"> <field name="TEXT">выходите в "what"</field> </shadow> </statement> </block> </value> </block> <sep></sep> <block type="instead_method0"></block> <block type="instead_method1"></block> <block type="lists_create_with"></block> ',N,L("Действия","actions_category"),'<label text="Текст"></label> <block type="instead_print"></block> <block type="text"></block> <block type="text_multiline"></block> <label text="Манипуляции над свойствами"></label> <block type="instead_take"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_drop"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_remove"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_disable"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_enable"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <label text="Параметр действия"></label> <block type="instead_self"></block> <block type="instead_what"></block> <block type="instead_object_ref"></block> <block type="instead_room_ref"></block> ',N,L("Условия","logic_category"),'<block type="controls_if"></block> <block type="logic_compare"></block> <block type="logic_operation"></block> <block type="logic_negate"></block> <block type="logic_boolean"></block> <block type="instead_where"> <value name="WHAT"> <shadow type="instead_self"></shadow> </value> </block> <block type="instead_return_false"></block> <block type="instead_self"></block> <block type="instead_what"></block> <block type="instead_object_ref"></block> <block type="instead_room_ref"></block> ',N,L("Математика","math_category"),'<block type="math_number"> <field name="NUM">42</field> </block> <block type="math_arithmetic"> <value name="A"> <shadow type="math_number"> <field name="NUM">1</field> </shadow> </value> <value name="B"> <shadow type="math_number"> <field name="NUM">1</field> </shadow> </value> </block> <block type="math_single"> <value name="NUM"> <shadow type="math_number"> <field name="NUM">9</field> </shadow> </value> </block> <block type="math_trig"> <value name="NUM"> <shadow type="math_number"> <field name="NUM">45</field> </shadow> </value> </block> <block type="math_constant"></block> <block type="math_number_property"> <value name="NUMBER_TO_CHECK"> <shadow type="math_number"> <field name="NUM">0</field> </shadow> </value> </block> <block type="math_round"> <value name="NUM"> <shadow type="math_number"> <field name="NUM">3.1</field> </shadow> </value> </block> <block type="math_modulo"> <value name="DIVIDEND"> <shadow type="math_number"> <field name="NUM">64</field> </shadow> </value> <value name="DIVISOR"> <shadow type="math_number"> <field name="NUM">10</field> </shadow> </value> </block> <block type="math_constrain"> <value name="VALUE"> <shadow type="math_number"> <field name="NUM">50</field> </shadow> </value> <value name="LOW"> <shadow type="math_number"> <field name="NUM">1</field> </shadow> </value> <value name="HIGH"> <shadow type="math_number"> <field name="NUM">100</field> </shadow> </value> </block> <block type="instead_rnd"> <value name="TO"> <shadow type="math_number"> <field name="NUM">42</field> </shadow> </value> </block> ',N,"<sep></sep>",'<category name="File" colour="215"> <button text="Edit game metadata" callbackKey="editMetadata"></button> <button text="Show Lua code" callbackKey="convertToLua"></button> <button text="Run" callbackKey="run"></button> <button text="Save in browser" callbackKey="save"></button> <sep></sep> <button text="Save to your computer" callbackKey="download"></button> <button text="Load from your computer" callbackKey="upload"></button> </category> '];return e.push("</xml>"),e.join("")}(),theme:o.Theme.defineTheme("instead",{base:"classic",categoryStyles:{rooms_category:{colour:"120"},objects_category:{colour:"60"},actions_category:{colour:"120"}},blockStyles:{rooms_blocks:{colourPrimary:"120"},objects_blocks:{colourPrimary:"60"},actions_blocks:{colourPrimary:"120"},properties_blocks:{colourPrimary:"30"}}}),move:{scrollbars:!0,wheel:!0},zoom:{controls:!0}});var j;if((j=x).registerButtonCallback("convertToLua",e=>{E(!1,e.getTargetWorkspace())}),j.registerButtonCallback("run",e=>{E(!0,e.getTargetWorkspace())}),j.registerButtonCallback("save",e=>{!function(e){const t=O(e);console.log("Saving text: "+t),window.localStorage.setItem("instead-data",t)}(e.getTargetWorkspace())}),j.registerButtonCallback("download",e=>{!function(e){I(this,void 0,void 0,(function*(){const t=new v,n=e.insteadMeta.name,a=O(e);t.file(n+"/blocks/main3.xml",a);const l=o.Lua.workspaceToCode(e);t.file(n+"/main3.lua",l);const s=yield t.generateAsync({type:"blob"});Object(g.saveAs)(s,n+".zip")}))}(e.getTargetWorkspace())}),j.registerButtonCallback("upload",e=>{(function(e){const t=document.getElementById("FileUploadInput");if(t)return t;const n=document.createElement("input");return n.accept=".zip",n.type="file",n.style.display="none",n.id="FileUploadInput",n.onchange=t=>{let n=t.target;if(!n.files)return;const o=new FileReader;o.onload=function(){n.value="",function(e,t){I(this,void 0,void 0,(function*(){const n=(yield v.loadAsync(t)).file(new RegExp("blocks/main3.xml$"))[0];n?A(yield n.async("string"),e):alert("Can't find blocks definition")}))}(e,this.result)},o.readAsArrayBuffer(n.files[0])},document.body.appendChild(n),n})(e.getTargetWorkspace()).click()}),j.registerButtonCallback("editMetadata",e=>{!function(e){I(this,void 0,void 0,(function*(){const t=e.insteadMeta,o=yield function(e){return w(this,void 0,void 0,(function*(){const t=document.createElement("div");try{document.body.appendChild(t),t.innerHTML=n("WfoH");const o=document.getElementById("game_info_dialog_ok"),a=document.getElementById("game_info_dialog_cancel"),l=document.getElementById("game_info_dialog_name"),s=document.getElementById("game_info_dialog_author"),i=document.getElementById("game_info_dialog_version");return e&&(l.value=e.name,s.value=e.author,i.value=e.version),yield new Promise((e,t)=>{o.onclick=t=>{e({name:l.value,author:s.value,version:i.value})},a.onclick=t=>{e()}})}finally{t.remove()}}))}(t);o&&(e.insteadMeta=o)}))}(e.getTargetWorkspace())}),x.addChangeListener(e=>{m.objectLifecycleListener(e)}),x.addChangeListener(e=>{f.objectLifecycleListener(e)}),function(){const e=document.getElementById("preview-pane");if(!e)return;const t=e.getElementsByClassName("btn");for(let e,n=0;e=t[n];n++)e.onclick=e=>C(n)}(),window.localStorage["instead-data"])console.log("Loading saved workspace"),A(window.localStorage["instead-data"],x);else{console.log("Loading default workspace");const e=n("7hEL").default,t=new XMLHttpRequest;t.onreadystatechange=function(){this.readyState===this.DONE&&200===this.status&&A(this.responseText,x)},t.open("GET",e,!0),t.send()}},zVD3:function(e,t,n){"use strict";t.a=n.p+"c2c4d61e148b644c8d471365c9ec7feb.svg"}});
//# sourceMappingURL=main.e9d84f81f4d8d58eb7fd.js.map